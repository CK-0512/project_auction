<script>
				   		 		let remainingTime = calculateRemainingTime();
								function calculateRemainingTime() {
								    const currentTime = new Date();
								    const endDateString = "${cart.endDate}";
						        	const endTime = new Date(endDateString.replace(/-/g, '/'));
								    const remainingTimeInSeconds = Math.max(0, Math.floor((endTime - currentTime) / 1000));
								    return remainingTimeInSeconds;
								};

						   		const auctionId = "${cart.auctionId}"

						   		const auctionSocket = new WebSocket("ws://localhost:8081/webSocket/auction?auctionId=" + auctionId);						   		
							    
						   		auctionSocket.onopen = () => {
						   		    console.log('Info : connection opened.');
							        const timerId = "remainTime-" + auctionId;
						   		 	const timerSpan = document.getElementById(timerId);
						   		 	if (timerSpan) {
							            updateCountdownTimer(timerSpan, remainingTime);
							        }
						   		};
						   		
						   		auctionSocket.onclose = function (event) {
									console.log('Info : connection closed.');
								};
								
								auctionSocket.onerror = function (err) {
									console.log('Error : ', err);
								};
						   		
						   		/*auctionSocket.onmessage = function (event) {
							        const data = JSON.parse(event.data);
							        console.log("Received data from WebSocket:", data);
							        const auctionId = data.auctionId;
							        const remainingTime = data.remainingTime;
	
							        const timerSpan = document.getElementById(`remainTime-${auctionId}`);
							        if (timerSpan) {
							            updateCountdownTimer(timerSpan, remainingTime);
							        }
								};*/
								
								    function updateCountdownTimer(element, remainingTime) {
								        const days = Math.floor(remainingTime / (60 * 60 * 24));
								        const hours = Math.floor((remainingTime % (60 * 60 * 24)) / (60 * 60));
								        const minutes = Math.floor((remainingTime % (60 * 60)) / 60);
								        const seconds = remainingTime % 60;
	
										let timerContent = days + "d " + hours + "h " + minutes + "m " + seconds + "s";
								        element.textContent = timerContent;
								        
								        remainingTime--;
								        
								        if (remainingTime >= 0) {
								            setTimeout(() => {
								                updateCountdownTimer(element, remainingTime);
								            }, 1000);
								        } else {
								        	const message = JSON.stringify({
								            	auctionId: auctionId,
								            	remainingTime: remainingTime
								        	});
								      		auctionSocket.send(message);
								        }
								        
								    }
								</script>